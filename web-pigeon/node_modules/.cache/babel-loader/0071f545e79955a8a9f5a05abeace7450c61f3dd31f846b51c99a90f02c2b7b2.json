{"ast":null,"code":"import{useState,useEffect,useContext}from\"react\";import{useNavigate,useParams}from\"react-router-dom\";import{AuthContext}from'./AuthContext';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const MessengerDetails=()=>{const{id}=useParams();const[messenger,setMessenger]=useState(null);const[newMessage,setNewMessage]=useState('');const[error,setError]=useState(null);const[isPending,setIsPending]=useState(true);const[isSending,setIsSending]=useState(false);const[showDeleteConfirm,setShowDeleteConfirm]=useState(false);const navigate=useNavigate();const{user}=useContext(AuthContext);const MAX_CHARACTERS=1000;useEffect(()=>{const fetchMessenger=async()=>{try{const response=await axios.get(\"http://localhost:5000/messengers/\".concat(id));setMessenger(response.data);setIsPending(false);}catch(err){setError(err.message);setIsPending(false);}};fetchMessenger();},[id]);const handleDeleteClick=()=>{setShowDeleteConfirm(true);};const handleDeleteConfirm=async()=>{try{await axios.delete(\"http://localhost:5000/messengers/\".concat(id));navigate('/');}catch(err){setError(err.message);}};const handleDeleteCancel=()=>{setShowDeleteConfirm(false);};const handleAddMessage=async e=>{e.preventDefault();if(!user){setError('You must be logged in to send a message');return;}if(newMessage.length>MAX_CHARACTERS){setError(\"Message exceeds \".concat(MAX_CHARACTERS,\" character limit\"));return;}setIsSending(true);try{await axios.post(\"http://localhost:5000/messengers/\".concat(id,\"/messages\"),{content:newMessage,username:user.username,timestamp:new Date().toISOString()});const response=await axios.get(\"http://localhost:5000/messengers/\".concat(id));setMessenger(response.data);setNewMessage('');setError(null);}catch(err){setError(err.message);}finally{setIsSending(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"messenger-details terminal-interface\",children:[isPending&&/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading...\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error}),messenger&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"terminal-header\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"MESSENGER: \",messenger.title]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"CREATOR: \",messenger.creator]})]}),user&&user.username===messenger.creator&&/*#__PURE__*/_jsx(\"button\",{onClick:handleDeleteClick,className:\"delete-btn\",children:\"DELETE\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"terminal-body\",children:/*#__PURE__*/_jsx(\"div\",{className:\"messages\",children:messenger.messages&&messenger.messages.map(message=>/*#__PURE__*/_jsxs(\"div\",{className:\"message\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"timestamp\",children:[\"[\",new Date(message.timestamp).toLocaleString(),\"]\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"username\",children:[message.username,\":\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"message-content\",children:message.content})]},message._id))})}),/*#__PURE__*/_jsxs(\"div\",{className:\"terminal-footer\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAddMessage,className:\"message-form\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"prompt\",children:\">\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newMessage,onChange:e=>setNewMessage(e.target.value),placeholder:\"Type your message...\",maxLength:MAX_CHARACTERS,disabled:isSending,required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:isSending,children:isSending?'Sending...':'SEND'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"character-count\",children:[newMessage.length,\"/\",MAX_CHARACTERS]})]})]}),showDeleteConfirm&&/*#__PURE__*/_jsxs(\"div\",{className:\"confirm-delete\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Are you sure you want to delete this messenger?\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDeleteConfirm,children:\"Yes, delete\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDeleteCancel,children:\"Cancel\"})]})]});};export default MessengerDetails;","map":{"version":3,"names":["useState","useEffect","useContext","useNavigate","useParams","AuthContext","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MessengerDetails","id","messenger","setMessenger","newMessage","setNewMessage","error","setError","isPending","setIsPending","isSending","setIsSending","showDeleteConfirm","setShowDeleteConfirm","navigate","user","MAX_CHARACTERS","fetchMessenger","response","get","concat","data","err","message","handleDeleteClick","handleDeleteConfirm","delete","handleDeleteCancel","handleAddMessage","e","preventDefault","length","post","content","username","timestamp","Date","toISOString","className","children","title","creator","onClick","messages","map","toLocaleString","_id","onSubmit","type","value","onChange","target","placeholder","maxLength","disabled","required"],"sources":["C:/Users/jense/Desktop/WebPigeon/web-pigeon/src/MessengerDetails.js"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport { AuthContext } from './AuthContext';\r\nimport axios from 'axios';\r\n\r\nconst MessengerDetails = () => {\r\n\r\n    const { id } = useParams();\r\n    const [messenger, setMessenger] = useState(null);\r\n    const [newMessage, setNewMessage] = useState('');\r\n    const [error, setError] = useState(null);\r\n    const [isPending, setIsPending] = useState(true);\r\n    const [isSending, setIsSending] = useState(false);\r\n    const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n    const navigate = useNavigate();\r\n    const { user } = useContext(AuthContext);\r\n\r\n    const MAX_CHARACTERS = 1000;\r\n\r\n    useEffect(() => {\r\n        const fetchMessenger = async () => {\r\n            try {\r\n                const response = await axios.get(`http://localhost:5000/messengers/${id}`);\r\n                setMessenger(response.data);\r\n                setIsPending(false);\r\n            } catch (err) {\r\n                setError(err.message);\r\n                setIsPending(false);\r\n            }\r\n        };\r\n        fetchMessenger();\r\n    }, [id]);\r\n\r\n    const handleDeleteClick = () => {\r\n        setShowDeleteConfirm(true);\r\n    };\r\n\r\n    const handleDeleteConfirm = async () => {\r\n        try {\r\n            await axios.delete(`http://localhost:5000/messengers/${id}`);\r\n            navigate('/');\r\n        } catch (err) {\r\n            setError(err.message);\r\n        }\r\n    };\r\n\r\n    const handleDeleteCancel = () => {\r\n        setShowDeleteConfirm(false);\r\n    };\r\n\r\n    const handleAddMessage = async (e) => {\r\n        e.preventDefault();\r\n        if (!user) {\r\n            setError('You must be logged in to send a message');\r\n            return;\r\n        }\r\n        if (newMessage.length > MAX_CHARACTERS) {\r\n            setError(`Message exceeds ${MAX_CHARACTERS} character limit`);\r\n            return;\r\n        }\r\n        setIsSending(true);\r\n        try {\r\n            await axios.post(`http://localhost:5000/messengers/${id}/messages`, {\r\n                content: newMessage,\r\n                username: user.username,\r\n                timestamp: new Date().toISOString()\r\n            });\r\n            const response = await axios.get(`http://localhost:5000/messengers/${id}`);\r\n            setMessenger(response.data);\r\n            setNewMessage('');\r\n            setError(null);\r\n        } catch (err) {\r\n            setError(err.message);\r\n        } finally {\r\n            setIsSending(false);\r\n        }\r\n    };\r\n\r\n    return ( \r\n        <div className=\"messenger-details terminal-interface\">\r\n            { isPending && <div className=\"loading\">Loading...</div> }\r\n            { error && <div className=\"error\">{ error }</div> }\r\n            { messenger && (\r\n                <>\r\n                    <div className=\"terminal-header\">\r\n                        <div>\r\n                            <h2>MESSENGER: {messenger.title}</h2>\r\n                            <p>CREATOR: {messenger.creator}</p>\r\n                        </div>\r\n                        {user && user.username === messenger.creator && (\r\n                            <button onClick={handleDeleteClick} className=\"delete-btn\">DELETE</button>\r\n                        )}\r\n                    </div>\r\n                    <div className=\"terminal-body\">\r\n                        <div className=\"messages\">\r\n                            {messenger.messages && messenger.messages.map(message => (\r\n                                <div key={message._id} className=\"message\">\r\n                                    <span className=\"timestamp\">[{new Date(message.timestamp).toLocaleString()}]</span>\r\n                                    <span className=\"username\">{message.username}:</span>\r\n                                    <span className=\"message-content\">{message.content}</span>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"terminal-footer\">\r\n                        <form onSubmit={handleAddMessage} className=\"message-form\">\r\n                            <span className=\"prompt\">&gt;</span>\r\n                            <input \r\n                                type=\"text\"\r\n                                value={newMessage}\r\n                                onChange={(e) => setNewMessage(e.target.value)}\r\n                                placeholder=\"Type your message...\"\r\n                                maxLength={MAX_CHARACTERS}\r\n                                disabled={isSending}\r\n                                required\r\n                            />\r\n                            <button type=\"submit\" disabled={isSending}>\r\n                                {isSending ? 'Sending...' : 'SEND'}\r\n                            </button>\r\n                        </form>\r\n                        <div className=\"character-count\">\r\n                            {newMessage.length}/{MAX_CHARACTERS}\r\n                        </div>\r\n                    </div>\r\n                </>\r\n            )}\r\n            {showDeleteConfirm && (\r\n                <div className=\"confirm-delete\">\r\n                    <p>Are you sure you want to delete this messenger?</p>\r\n                    <button onClick={handleDeleteConfirm}>Yes, delete</button>\r\n                    <button onClick={handleDeleteCancel}>Cancel</button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n \r\nexport default MessengerDetails;    "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}